# REST API

## Peer

- `Get` /api/peer/ping

返回节点的程序版本、系统类型、以及区块高度

例：

```json
{
    "version": "v1.0",
    "os": "linux",
    "blockHeight": 5
}
```

- `Post` /api/peer/connect

与一个节点相连，获取远程节点所连接的节点并储存

例：

```json
{
    "xxxxxxx": {
        "host": "8.8.8.8",
        "port": 2334,
        "state": 2
    },
    "xxx": {
        "host": "123.435.433",
        "port": 1121,
        "state": 1
    }
}

```

- `Get` /api/peer/getPeers

获取节点所连接的节点

例：

```js
let client = request.createClient(url)
let postData = { host: "123.233.233", port: 2333 }
client.post(postData)
```
返回信息：
```json
{
    "xxxxxxx": {
        "host": "8.8.8.8",
        "port": 2334,
        "state": 2
    },
    "xxx": {
        "host": "123.435.433",
        "port": 1121,
        "state": 1
    }
}

```

## Block

- `Get` /api/block/block

通过url query获取一个区块，例如 `Get` /api/block/block?flag=1

返回：

```json
{
  "block": "f90309f9018fa02923f3fa0babe5df18c4d7f5fab35e40a079314678f7511895d611828d1410aaa016249774b7554a5725bfb1760ad72c65dd5017ff35ce3ef19e53840773fd5567a0e8823b3923ac638399c817a02c0af8d7e0ed6cd5ac04dbb5af09d12794504fb0a056e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421b9010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000018459e015b98080f90174f862809428afa8e02eeeef86d720db1c04dcfabd93ae03a10a86015eed7557ee801ba02e7251cabdd37572775542dc0bc0e651583c66db8cf19b1d2cd39a1eaca87703a005f753b50688cb48a671f72cd46f415a635545f2d50163a7a2b0b8e73bda930ff862809438afa8e02eeeef86d720db1c04dcfabd93ae03a10186015eed7557ee801ba0bfbe9276937212191aa9983e7b8e67d29ffdf9067c73b5ead2942bc6c2b9be61a01a9ef4fc01328a3afe10118401d690eb9e09ba17aae9800e92108beb864fa03ef85402800386015eed7557ee8666756c696e671ba08c0fc5a062929de537daabab5d3085bec08201a8a5e27b57aeebd804fbb0b313a05b1a07fd5f52d0451d6df9cd9fdd3c3bac50fb2c696131f760009b44cfd44fa2f85401800386015eed7557ee8666756c696e671ca0dba59d90799c56a46a09605296d7297186ca5d7cfb4b266231255e74fa800286a065a12f17edc18633b8124757b66a4b9686f56a14f912191a99ef3953cedc789f"
}
```
!> 此处得到的block是经过序列化的

- `Get` /api/block/blocks
通过url query获取一个节点，例如 `Get` /api/block/block?start=0&end=1

返回

```json
{
  "blocks": [
    "f90309f9018fa02923f3fa0babe5df18c4d7f5fab35e40a079314678f7511895d611828d1410aaa016249774b7554a5725bfb1760ad72c65dd5017ff35ce3ef19e53840773fd5567a0e8823b3923ac638399c817a02c0af8d7e0ed6cd5ac04dbb5af09d12794504fb0a056e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421b9010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000018459e015b98080f90174f862809428afa8e02eeeef86d720db1c04dcfabd93ae03a10a86015eed7557ee801ba02e7251cabdd37572775542dc0bc0e651583c66db8cf19b1d2cd39a1eaca87703a005f753b50688cb48a671f72cd46f415a635545f2d50163a7a2b0b8e73bda930ff862809438afa8e02eeeef86d720db1c04dcfabd93ae03a10186015eed7557ee801ba0bfbe9276937212191aa9983e7b8e67d29ffdf9067c73b5ead2942bc6c2b9be61a01a9ef4fc01328a3afe10118401d690eb9e09ba17aae9800e92108beb864fa03ef85402800386015eed7557ee8666756c696e671ba08c0fc5a062929de537daabab5d3085bec08201a8a5e27b57aeebd804fbb0b313a05b1a07fd5f52d0451d6df9cd9fdd3c3bac50fb2c696131f760009b44cfd44fa2f85401800386015eed7557ee8666756c696e671ca0dba59d90799c56a46a09605296d7297186ca5d7cfb4b266231255e74fa800286a065a12f17edc18633b8124757b66a4b9686f56a14f912191a99ef3953cedc789f",
    "f90309f9018fa099d6529383d6623b944cb97dc623e04a187060d0d4de5d41ef9e4460141dc9f4a08e2f9624644ea72cbe22efbe87eb00f526102ae618578ac317a85339faeaceb5a0e8823b3923ac638399c817a02c0af8d7e0ed6cd5ac04dbb5af09d12794504fb0a056e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421b9010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000028459e015bc8080f90174f862809428afa8e02eeeef86d720db1c04dcfabd93ae03a10a86015eed7557ee801ba02e7251cabdd37572775542dc0bc0e651583c66db8cf19b1d2cd39a1eaca87703a005f753b50688cb48a671f72cd46f415a635545f2d50163a7a2b0b8e73bda930ff862809438afa8e02eeeef86d720db1c04dcfabd93ae03a10186015eed7557ee801ba0bfbe9276937212191aa9983e7b8e67d29ffdf9067c73b5ead2942bc6c2b9be61a01a9ef4fc01328a3afe10118401d690eb9e09ba17aae9800e92108beb864fa03ef85402800386015eed7557ee8666756c696e671ba08c0fc5a062929de537daabab5d3085bec08201a8a5e27b57aeebd804fbb0b313a05b1a07fd5f52d0451d6df9cd9fdd3c3bac50fb2c696131f760009b44cfd44fa2f85401800386015eed7557ee8666756c696e671ca0dba59d90799c56a46a09605296d7297186ca5d7cfb4b266231255e74fa800286a065a12f17edc18633b8124757b66a4b9686f56a14f912191a99ef3953cedc789f"
  ]
}
```

- `Post` /api/block/vote

用于收集PBFT的投票信息，需要post的信息有h,k,s
其中`h`为区块哈希， `k`为节点公钥，`s`为签名

例如：

```js
postData = {"h":"21dsdnsaopksakodkasop", "k":"sadadsadwewqdsad", "s":"sadadsdasdasdsa"}
client.post(postData)
```

若成功则返回：

```json
{ "msg": "add a vote" }
```

- `Post` /api/block/receiveBlock

用于在共识过程中获取区块，需要post的信息有 h, b, s, k
其中，`h`为区块哈希，`b`为区块序列化后的字符串， `k`为节点公钥，`s`为签名

例如：

```js
postData = {"h":"21dsdnsaopksakodkasop", "b": "f90309f9018fa02923f3fa0babe5df18c4d7f5fab35e40a079314678f7511895d611828d1410aaa016249774b7554a5725bfb1760ad72c65dd5017ff35ce3ef19e53840773fd5567a0e8823b3923ac638399c817a02c0af8d7e0ed6cd5ac04dbb5af09d12794504fb0a056e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421b9010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000018459e015b98080f90174f862809428afa8e02eeeef86d720db1c04dcfabd93ae03a10a86015eed7557ee801ba02e7251cabdd37572775542dc0bc0e651583c66db8cf19b1d2cd39a1eaca87703a005f753b50688cb48a671f72cd46f415a635545f2d50163a7a2b0b8e73bda930ff862809438afa8e02eeeef86d720db1c04dcfabd93ae03a10186015eed7557ee801ba0bfbe9276937212191aa9983e7b8e67d29ffdf9067c73b5ead2942bc6c2b9be61a01a9ef4fc01328a3afe10118401d690eb9e09ba17aae9800e92108beb864fa03ef85402800386015eed7557ee8666756c696e671ba08c0fc5a062929de537daabab5d3085bec08201a8a5e27b57aeebd804fbb0b313a05b1a07fd5f52d0451d6df9cd9fdd3c3bac50fb2c696131f760009b44cfd44fa2f85401800386015eed7557ee8666756c696e671ca0dba59d90799c56a46a09605296d7297186ca5d7cfb4b266231255e74fa800286a065a12f17edc18633b8124757b66a4b9686f56a14f912191a99ef3953cedc789f","k":"sadadsadwewqdsad", "s":"sadadsdasdasdsa"}
client.post(postData)
```

在此过程中，节点将验证h,b,s,k的合法性。
若成功则返回：

```json
{ "msg": "block is true", "state": 1 }
```

## Transaction

- `Post` /api/transaction/receiveTransaction

用于接收其它节点发送的交易，此API接受一个序列化的字符串

例如：

```js
postData = {"serializeTx":"21dsdnsaopksakodkasopsadsadahiasjiodjoasdadjio"}
client.post(postData)
```

若成功则返回：

```json
{ "msg": "transaction is received" }
```

- `Post` /api/transaction/sendTransaction

用于向其它节点广播交易，接受`to`, `value`, `timestamp`, `data`四个字段
其中，`to`是接收者的地址，应为字符串，`value`是交易量，应为数字，`timestamp`是时间戳，应为数字， `data`是一个字符

例如：

```js
postData = {"to":"21dsdnsaopksakodkasopsadsadahia", "value": 5, "timestamp": 146666, "data":"from fuling"}
client.post(postData)
```

若data包含字符串，则需要更多value。

若成功则返回：

```json
{
    "to": "xxx",
    "value": 5,
    "timestamp": 12366666,
    "data": "xxxxx"
}
```

## consensus

- `Post` /api/consensus/registerSenator
接受`privateKey`,`data`, `timestamp`三个字段即私钥匙，数据，时间戳。
data为一个议员注册者的名字字符串。

例如：

```js
postData = {"privateKey":"21dsdnsaopksakodkasopsadsadahia", "data": "fuling", "timestamp": 146666}
client.post(postData)
```

若成功则返回议员的注册名称

```json
{"fuling"}
```

- `Post` /api/consensus/addVote

接受`privateKey`,`data`, `timestamp`三个字段即私钥匙，数据，时间戳。
data为一个议员注册者的名字字符串。

例如：

```js
postData = {"privateKey":"21dsdnsaopksakodkasopsadsadahia", "data": "fuling", "timestamp": 146666}
client.post(postData)
```

若成功则返回所投票的议员名称

```json
{"fuling"}
```

- `Get` /api/consensus/getSenators

返回：

```bash
{
    "xxxxxxx": {
        "name": "fuling",
        "publicKey": "xxxxxxxxx"
        },
    "xxxxxxx": {
        "name": "fulingingling",
        "publicKey": "xxxxxxxxx"
        } 
}
```

## ACcount

- `Get` /api/wallet/account/createAccount

获取一个私钥，一个公钥以及一个地址

- `Post` /api/wallet/account/login

接受一个私钥

例如：

```js
postData = {"privateKey":"21dsdnsaopksakodkasopsadsadahia"}
client.post(postData)
```

若成功则返回所投票的议员名称

```json
{"msg": "login successful"}
```